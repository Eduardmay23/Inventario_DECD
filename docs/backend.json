{
  "entities": {
    "Product": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Product",
      "type": "object",
      "description": "Represents a product in the inventory.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the product."
        },
        "name": {
          "type": "string",
          "description": "The name of the product."
        },
        "description": {
          "type": "string",
          "description": "A detailed description of the product."
        },
        "sku": {
          "type": "string",
          "description": "The Stock Keeping Unit (SKU) of the product."
        },
        "categoryId": {
          "type": "string",
          "description": "Reference to Category. (Relationship: Category 1:N Product)"
        }
      },
      "required": [
        "id",
        "name",
        "description",
        "sku",
        "categoryId"
      ]
    },
    "Category": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Category",
      "type": "object",
      "description": "Represents a category of products.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the category."
        },
        "name": {
          "type": "string",
          "description": "The name of the category."
        },
        "description": {
          "type": "string",
          "description": "A description of the category."
        }
      },
      "required": [
        "id",
        "name",
        "description"
      ]
    },
    "StockLevel": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "StockLevel",
      "type": "object",
      "description": "Represents the stock level of a product at a specific location.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the stock level record."
        },
        "productId": {
          "type": "string",
          "description": "Reference to Product. (Relationship: Product 1:N StockLevel)"
        },
        "locationId": {
          "type": "string",
          "description": "Reference to Location. (Relationship: Location 1:N StockLevel)"
        },
        "quantity": {
          "type": "number",
          "description": "The quantity of the product in stock."
        },
        "lastUpdated": {
          "type": "string",
          "description": "The timestamp of the last stock level update.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "productId",
        "locationId",
        "quantity",
        "lastUpdated"
      ]
    },
    "Location": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Location",
      "type": "object",
      "description": "Represents a storage location.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the location."
        },
        "name": {
          "type": "string",
          "description": "The name of the location."
        },
        "description": {
          "type": "string",
          "description": "A description of the location."
        }
      },
      "required": [
        "id",
        "name",
        "description"
      ]
    },
    "StockAlert": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "StockAlert",
      "type": "object",
      "description": "Represents an alert for low stock levels.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the stock alert."
        },
        "productId": {
          "type": "string",
          "description": "Reference to Product. (Relationship: Product 1:N StockAlert)"
        },
        "threshold": {
          "type": "number",
          "description": "The threshold at which the alert is triggered."
        },
        "email": {
          "type": "string",
          "description": "Email address to send alert to.",
          "format": "email"
        },
        "isActive": {
          "type": "boolean",
          "description": "Indicates whether the alert is currently active."
        }
      },
      "required": [
        "id",
        "productId",
        "threshold",
        "isActive"
      ]
    },
    "StockMovement": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "StockMovement",
      "type": "object",
      "description": "Represents a movement of stock (e.g., addition, removal).",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the stock movement record."
        },
        "productId": {
          "type": "string",
          "description": "Reference to Product. (Relationship: Product 1:N StockMovement)"
        },
        "locationId": {
          "type": "string",
          "description": "Reference to Location. (Relationship: Location 1:N StockMovement)"
        },
        "quantityChange": {
          "type": "number",
          "description": "The change in quantity of the product."
        },
        "movementDate": {
          "type": "string",
          "description": "The date and time of the stock movement.",
          "format": "date-time"
        },
        "type": {
          "type": "string",
          "description": "Type of stock movement (e.g., 'addition', 'removal')."
        },
        "reason": {
          "type": "string",
          "description": "Reason for the stock movement."
        }
      },
      "required": [
        "id",
        "productId",
        "locationId",
        "quantityChange",
        "movementDate",
        "type",
        "reason"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/categories/{categoryId}",
        "definition": {
          "entityName": "Category",
          "schema": {
            "$ref": "#/backend/entities/Category"
          },
          "description": "Stores product categories. No denormalized authorization fields required.",
          "params": [
            {
              "name": "categoryId",
              "description": "Unique identifier for the category."
            }
          ]
        }
      },
      {
        "path": "/products/{productId}",
        "definition": {
          "entityName": "Product",
          "schema": {
            "$ref": "#/backend/entities/Product"
          },
          "description": "Stores product information.  No denormalized authorization fields required.",
          "params": [
            {
              "name": "productId",
              "description": "Unique identifier for the product."
            }
          ]
        }
      },
      {
        "path": "/stock_levels/{stockLevelId}",
        "definition": {
          "entityName": "StockLevel",
          "schema": {
            "$ref": "#/backend/entities/StockLevel"
          },
          "description": "Stores stock levels for each product at each location. No denormalized authorization fields required.",
          "params": [
            {
              "name": "stockLevelId",
              "description": "Unique identifier for the stock level record."
            }
          ]
        }
      },
      {
        "path": "/locations/{locationId}",
        "definition": {
          "entityName": "Location",
          "schema": {
            "$ref": "#/backend/entities/Location"
          },
          "description": "Stores location information. No denormalized authorization fields required.",
          "params": [
            {
              "name": "locationId",
              "description": "Unique identifier for the location."
            }
          ]
        }
      },
      {
        "path": "/stock_alerts/{stockAlertId}",
        "definition": {
          "entityName": "StockAlert",
          "schema": {
            "$ref": "#/backend/entities/StockAlert"
          },
          "description": "Stores stock alerts. No denormalized authorization fields required.",
          "params": [
            {
              "name": "stockAlertId",
              "description": "Unique identifier for the stock alert."
            }
          ]
        }
      },
      {
        "path": "/stock_movements/{stockMovementId}",
        "definition": {
          "entityName": "StockMovement",
          "schema": {
            "$ref": "#/backend/entities/StockMovement"
          },
          "description": "Stores stock movement history. No denormalized authorization fields required.",
          "params": [
            {
              "name": "stockMovementId",
              "description": "Unique identifier for the stock movement record."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure for StockWise is designed to ensure security, scalability, and ease of debugging, adhering to the principles of Authorization Independence, Clarity of Intent, DBAC (Database-Based Access Control), and QAPs (Rules are not Filters). It focuses on product tracking, stock alerts, and reporting, while also supporting AI-driven summarization.\n\n*   **Authorization Independence:**  There is no need for complex authorization for this app. All write operations are available to all users, and there is no role based restrictions on editing product information.\n*   **Structural Segregation:** Each collection houses a specific entity type, ensuring a homogeneous security posture within each collection. This segregation simplifies security rules by aligning data with similar access requirements.\n*   **Access Modeling:** The structure uses straightforward path-based access for entities. There is no user data involved in this application, so any type of path-based ownership is not used.\n*   **Data Clarity:** Explicit state modeling (if needed for future features) and predictable schemas are encouraged for maintainability.\n*   **Querying and QAPs:**  The structural segregation supports secure `list` operations (QAPs).  Rules can efficiently filter data at the collection level.\n\n"
  }
}