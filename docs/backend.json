
{
  "entities": {
    "Product": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Product",
      "type": "object",
      "description": "Represents a product in the inventory.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the product."
        },
        "name": {
          "type": "string",
          "description": "Name of the product."
        },
        "category": {
          "type": "string",
          "description": "Category the product belongs to."
        },
        "location": {
            "type": "string",
            "description": "Physical location of the product in the warehouse."
        },
        "quantity": {
            "type": "number",
            "description": "Current stock quantity."
        },
        "reorderPoint": {
            "type": "number",
            "description": "The stock level at which a reorder should be triggered."
        }
      },
      "required": [
        "id",
        "name",
        "category",
        "location",
        "quantity",
        "reorderPoint"
      ]
    },
    "Location": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Location",
      "type": "object",
      "description": "Represents a physical location where products are stored.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the location."
        },
        "name": {
          "type": "string",
          "description": "Name of the location (e.g., Warehouse A, Shelf 2)."
        },
        "address": {
          "type": "string",
          "description": "Address of the location."
        }
      },
      "required": [
        "id",
        "name",
        "address"
      ]
    },
    "Loan": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "title": "Loan",
        "description": "Represents a record of a product being loaned out.",
        "type": "object",
        "properties": {
            "id": {"type": "string"},
            "productId": {"type": "string"},
            "productName": {"type": "string"},
            "requester": {"type": "string"},
            "loanDate": {"type": "string", "format": "date-time"},
            "quantity": {"type": "number"},
            "status": {"type": "string", "enum": ["Prestado", "Devuelto"]}
        },
        "required": ["id", "productId", "productName", "requester", "loanDate", "quantity", "status"]
    },
    "StockMovement": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "StockMovement",
      "type": "object",
      "description": "Represents a movement of stock, such as a delivery or a sale.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the stock movement."
        },
        "productId": {
          "type": "string",
          "description": "Reference to Product. (Relationship: Product 1:N StockMovement)"
        },
        "productName": {
            "type": "string"
        },
        "quantity": {
          "type": "number",
          "description": "The quantity of the product that was moved."
        },
        "date": {
          "type": "string",
          "description": "Date and time the stock movement occurred.",
          "format": "date-time"
        },
        "type": {
          "type": "string",
          "description": "The type of stock movement (e.g., descuento, incremento)."
        },
        "reason": {
            "type": "string"
        }
      },
      "required": [
        "id",
        "productId",
        "productName",
        "quantity",
        "date",
        "type",
        "reason"
      ]
    },
    "User": {
        "title": "User",
        "description": "Represents a user account in the system.",
        "type": "object",
        "properties": {
            "id": {"type": "string"},
            "uid": {"type": "string"},
            "name": {"type": "string"},
            "username": {"type": "string"},
            "role": {"type": "string", "enum": ["admin", "user"]},
            "permissions": {"type": "array", "items": {"type": "string"}}
        },
        "required": ["id", "uid", "name", "username", "role"]
    }
  },
  "auth": {
    "providers": [
      "password"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/products/{productId}",
        "definition": {
          "entityName": "Product",
          "schema": {
            "$ref": "#/backend/entities/Product"
          },
          "description": "Stores all product information."
        }
      },
      {
        "path": "/locations/{locationId}",
        "definition": {
          "entityName": "Location",
          "schema": {
            "$ref": "#/backend/entities/Location"
          },
          "description": "Stores information about physical warehouse locations."
        }
      },
      {
        "path": "/loans/{loanId}",
        "definition": {
          "entityName": "Loan",
          "schema": {
            "$ref": "#/backend/entities/Loan"
          },
          "description": "Stores records of all product loans."
        }
      },
      {
        "path": "/movements/{movementId}",
        "definition": {
            "entityName": "StockMovement",
            "schema": {
                "$ref": "#/backend/entities/StockMovement"
            },
            "description": "Stores records of all stock movements, like adjustments or damages."
        }
      },
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user profiles and their specific permissions."
        }
      }
    ],
    "reasoning": "The Firestore structure for StockWise is designed to provide a secure and scalable inventory management system. It prioritizes authorization independence and simplifies security rules. Core data such as Products, Locations, Loans, and Movements are stored at the root for global access and simplified querying. User-specific data is stored under a /users collection to manage permissions and access control centrally."
  }
}
